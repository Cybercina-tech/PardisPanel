{% extends "base.html" %}
{% load telegram_tags %}

{% block title %}Settings - Sarafi Pardis Panel{% endblock %}

{% block extra_head %}
<style>
/* Settings Page Specific Styles */
.settings-container {
    max-width: 100%;
    margin: 0;
    padding: 0;
}

.settings-wrapper {
    display: flex;
    gap: 2rem;
    min-height: calc(100vh - 300px);
    align-items: flex-start;
}

/* Sidebar Styles */
.settings-sidebar {
    width: 280px;
    flex-shrink: 0;
    background: var(--color-surface);
    border-radius: var(--radius-md);
    padding: 1.5rem 0;
    box-shadow: var(--color-shadow-soft);
    height: fit-content;
    position: sticky;
    top: 2rem;
}

.settings-sidebar-header {
    padding: 0 1.5rem 1.5rem;
    border-bottom: 1px solid var(--color-border);
    margin-bottom: 1rem;
}

.settings-sidebar-header h2 {
    font-size: 1.5rem;
    font-weight: 700;
    color: var(--color-heading);
    margin: 0;
}

.settings-nav {
    list-style: none;
    padding: 0;
    margin: 0;
}

.settings-nav-item {
    margin: 0.25rem 0;
}

.settings-nav-link {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    padding: 0.875rem 1.5rem;
    color: var(--color-text);
    text-decoration: none;
    transition: all var(--transition-fast);
    border-left: 3px solid transparent;
    font-weight: 500;
}

.settings-nav-link:hover {
    background: var(--color-surface-alt);
    color: var(--color-accent);
    border-left-color: var(--color-accent-soft);
}

.settings-nav-link.active {
    background: var(--color-accent-soft);
    color: var(--color-accent);
    border-left-color: var(--color-accent);
    font-weight: 600;
}

.settings-nav-link i {
    font-size: 1.125rem;
    width: 20px;
    text-align: center;
}

/* Main Content Area */
.settings-content {
    flex: 1;
    min-width: 0;
}

.settings-section-content {
    display: none;
    animation: fadeIn 0.3s ease-in;
}

.settings-section-content.active {
    display: block;
}

@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.settings-section-card {
    background: var(--color-surface);
    border-radius: var(--radius-md);
    padding: 2rem;
    margin-bottom: 1.5rem;
    box-shadow: var(--color-shadow-soft);
}

.settings-section-header {
    margin-bottom: 2rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid var(--color-border);
}

.settings-section-header h2 {
    font-size: 1.75rem;
    font-weight: 700;
    color: var(--color-heading);
    margin: 0 0 0.5rem;
}

.settings-section-description {
    color: var(--color-text-muted);
    font-size: 0.9375rem;
    margin: 0;
    line-height: 1.6;
}

/* Form Groups */
.settings-form-group {
    margin-bottom: 2rem;
}

.settings-form-group:last-child {
    margin-bottom: 0;
}

.settings-form-group h3 {
    font-size: 1.125rem;
    font-weight: 600;
    color: var(--color-heading);
    margin: 0 0 0.75rem;
}

.settings-form-group p {
    color: var(--color-text-muted);
    font-size: 0.875rem;
    margin: 0 0 1.25rem;
    line-height: 1.5;
}

/* Form Fields */
.settings-form-field {
    margin-bottom: 1.5rem;
}

.settings-form-field .btn-group .btn.active {
    background-color: var(--color-accent) !important;
    color: var(--btn-text-on-accent) !important;
    border-color: var(--color-accent) !important;
}

.settings-form-field .btn-group .btn:not(.active) {
    background-color: transparent !important;
    color: var(--color-accent) !important;
}

.settings-form-field label {
    display: block;
    font-weight: 600;
    color: var(--color-heading);
    margin-bottom: 0.5rem;
    font-size: 0.9375rem;
}

.settings-form-field .form-control,
.settings-form-field .form-select {
    width: 100%;
    padding: 0.75rem 1rem;
    border: 1px solid var(--color-border);
    border-radius: var(--radius-sm);
    background: var(--input-bg);
    color: var(--color-text);
    font-size: 0.9375rem;
    transition: all var(--transition-fast);
}

.settings-form-field .form-control:focus,
.settings-form-field .form-select:focus {
    outline: none;
    border-color: var(--color-accent);
    box-shadow: 0 0 0 3px var(--color-focus-ring);
}

.settings-form-field .form-text {
    display: block;
    margin-top: 0.5rem;
    font-size: 0.8125rem;
    color: var(--color-text-muted);
}

.settings-form-field .invalid-feedback {
    display: block;
    margin-top: 0.5rem;
    font-size: 0.8125rem;
    color: var(--color-danger);
}

/* Grid Layout for Forms */
.settings-form-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1.5rem;
}

.settings-form-grid.full-width {
    grid-template-columns: 1fr;
}

/* Save Button */
.settings-save-btn {
    margin-top: 2rem;
    padding-top: 1.5rem;
    border-top: 1px solid var(--color-border);
}

.settings-save-btn .btn {
    min-width: 140px;
}

/* Status Messages */
.settings-status {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.5rem 1rem;
    border-radius: var(--radius-sm);
    font-size: 0.875rem;
    font-weight: 500;
    margin-left: 1rem;
    opacity: 0;
    transform: translateY(-5px);
    transition: all var(--transition-fast);
}

.settings-status.show {
    opacity: 1;
    transform: translateY(0);
}

.settings-status.saving {
    background: var(--color-info-soft);
    color: var(--color-info-strong);
}

.settings-status.saved {
    background: var(--color-success-soft);
    color: var(--color-success);
}

.settings-status.error {
    background: rgba(215, 111, 122, 0.15);
    color: var(--color-danger);
}

/* Table Styles */
.settings-table {
    width: 100%;
    border-collapse: collapse;
}

.settings-table thead {
    background: var(--color-surface-alt);
}

.settings-table th {
    padding: 1rem;
    text-align: right;
    font-weight: 600;
    color: var(--color-heading);
    font-size: 0.875rem;
    border-bottom: 1px solid var(--color-border);
}

.settings-table td {
    padding: 1rem;
    color: var(--color-text);
    border-bottom: 1px solid var(--color-border);
}

.settings-table tbody tr:hover {
    background: var(--color-surface-alt);
}

/* Mobile Responsive */
@media (max-width: 992px) {
    .settings-wrapper {
        flex-direction: column;
    }
    
    .settings-sidebar {
        width: 100%;
        position: relative;
        top: 0;
        margin-bottom: 1.5rem;
    }
    
    .settings-nav {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
        padding: 0 1rem;
    }
    
    .settings-nav-link {
        border-left: none;
        border-bottom: 3px solid transparent;
        border-radius: var(--radius-sm);
        padding: 0.75rem 1.25rem;
    }
    
    .settings-nav-link.active {
        border-left: none;
        border-bottom-color: var(--color-accent);
    }
    
    .settings-section-card {
        padding: 1.5rem;
    }
    
    .settings-form-grid {
        grid-template-columns: 1fr;
    }
}

@media (max-width: 576px) {
    .settings-container {
        padding: 1rem 0;
    }
    
    .settings-section-card {
        padding: 1.25rem;
    }
    
    .settings-section-header h2 {
        font-size: 1.5rem;
    }
}

/* Empty State */
.settings-empty-state {
    text-align: center;
    padding: 3rem 1rem;
    color: var(--color-text-muted);
}

.settings-empty-state i {
    font-size: 3rem;
    margin-bottom: 1rem;
    opacity: 0.5;
}

.settings-empty-state p {
    font-size: 0.9375rem;
    margin: 0;
}

/* Divider */
.settings-divider {
    height: 1px;
    background: var(--color-border);
    margin: 2rem 0;
    border: none;
}
</style>
{% endblock %}

{% block content %}
<div class="settings-container">
    <div class="settings-wrapper">
        <!-- Sidebar Navigation -->
        <aside class="settings-sidebar">
            <div class="settings-sidebar-header">
                <h2><i class="fas fa-cog me-2"></i>Settings</h2>
            </div>
            <nav>
                <ul class="settings-nav">
                    <li class="settings-nav-item">
                        <a href="?section=general" class="settings-nav-link {% if active_section == 'general' %}active{% endif %}" data-section="general">
                            <i class="fas fa-sliders-h"></i>
                            <span>General</span>
                        </a>
                    </li>
                    <li class="settings-nav-item">
                        <a href="?section=appearance" class="settings-nav-link {% if active_section == 'appearance' %}active{% endif %}" data-section="appearance">
                            <i class="fas fa-palette"></i>
                            <span>Appearance</span>
                        </a>
                    </li>
                    <li class="settings-nav-item">
                        <a href="?section=telegram" class="settings-nav-link {% if active_section == 'telegram' %}active{% endif %}" data-section="telegram">
                            <i class="fab fa-telegram-plane"></i>
                            <span>Telegram</span>
                        </a>
                    </li>
                    <li class="settings-nav-item">
                        <a href="?section=notifications" class="settings-nav-link {% if active_section == 'notifications' %}active{% endif %}" data-section="notifications">
                            <i class="fas fa-bell"></i>
                            <span>Notifications</span>
                        </a>
                    </li>
                    <li class="settings-nav-item">
                        <a href="?section=advanced" class="settings-nav-link {% if active_section == 'advanced' %}active{% endif %}" data-section="advanced">
                            <i class="fas fa-code"></i>
                            <span>Advanced</span>
                        </a>
                    </li>
                </ul>
            </nav>
        </aside>

        <!-- Main Content -->
        <main class="settings-content">
            <!-- General Section -->
            <div class="settings-section-content {% if active_section == 'general' %}active{% endif %}" id="section-general">
                <div class="settings-section-card">
                    <div class="settings-section-header">
                        <h2>General Settings</h2>
                        <p class="settings-section-description">Manage your application's basic configuration and preferences.</p>
                    </div>

                    <div class="settings-form-group">
                        <h3>System Information</h3>
                        <p>View and manage system-wide settings and information.</p>
                        
                        <div class="settings-form-field">
                            <label>Application Name</label>
                            <input type="text" class="form-control" value="Sarafi Pardis Panel" readonly>
                            <small class="form-text">The name of your application.</small>
                        </div>
                    </div>

                    <div class="settings-form-group">
                        <h3>Quick Links</h3>
                        <p>Access frequently used sections from settings.</p>
                        
                        <div class="settings-form-grid">
                            <div class="settings-section-card" style="padding: 1.5rem; margin-bottom: 0;">
                                <h4 style="font-size: 1rem; margin-bottom: 0.5rem; color: var(--color-heading);">
                                    <i class="fas fa-images me-2"></i>Template Dashboard
                                </h4>
                                <p style="font-size: 0.875rem; color: var(--color-text-muted); margin-bottom: 1rem;">
                                    Manage templates for Telegram price posts
                                </p>
                                <a href="{% url 'price_publisher:template_dashboard' %}" class="btn btn-sm btn-outline-accent">
                                    <i class="fas fa-external-link-alt me-2"></i>Open Dashboard
                                </a>
                            </div>
                            
                            <div class="settings-section-card" style="padding: 1.5rem; margin-bottom: 0;">
                                <h4 style="font-size: 1rem; margin-bottom: 0.5rem; color: var(--color-heading);">
                                    <i class="fas fa-file-alt me-2"></i>Application Logs
                                </h4>
                                <p style="font-size: 0.875rem; color: var(--color-text-muted); margin-bottom: 1rem;">
                                    View system logs and activity
                                </p>
                                <a href="{% url 'setting:logs' %}" class="btn btn-sm btn-outline-accent">
                                    <i class="fas fa-external-link-alt me-2"></i>View Logs
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Appearance Section -->
            <div class="settings-section-content {% if active_section == 'appearance' %}active{% endif %}" id="section-appearance">
                <div class="settings-section-card">
                    <div class="settings-section-header">
                        <h2>Appearance</h2>
                        <p class="settings-section-description">Customize the look and feel of your dashboard and interface.</p>
                    </div>

                    <div class="settings-form-group">
                        <h3>Theme Selection</h3>
                        <p>Choose between light and dark themes. Your preference is saved automatically.</p>
                        
                        <div class="settings-form-field">
                            <label>Current Theme</label>
                            <div class="btn-group" role="group" style="width: 100%; max-width: 400px;">
                                <button type="button" class="btn btn-outline-accent" data-theme="dark" id="themeDarkBtn">
                                    <i class="fas fa-moon me-2"></i>Dark
                                </button>
                                <button type="button" class="btn btn-outline-accent" data-theme="light" id="themeLightBtn">
                                    <i class="fas fa-sun me-2"></i>Light
                                </button>
                            </div>
                            <small class="form-text">The dark theme uses gold accents, while the light theme uses blue accents.</small>
                        </div>
                    </div>

                    <div class="settings-save-btn">
                        <button type="button" class="btn btn-gold" onclick="showSaveStatus('appearance')">
                            <i class="fas fa-save me-2"></i>Save Changes
                        </button>
                        <span class="settings-status" id="status-appearance"></span>
                    </div>
                </div>
            </div>

            <!-- Telegram Section -->
            <div class="settings-section-content {% if active_section == 'telegram' %}active{% endif %}" id="section-telegram">
                <!-- Bots Management -->
                <div class="settings-section-card">
                    <div class="settings-section-header">
                        <h2>Telegram Bots</h2>
                        <p class="settings-section-description">Manage your Telegram bot configurations and credentials.</p>
                    </div>

                    <div class="settings-form-group">
                        <h3>Add New Bot</h3>
                        <p>Configure a new Telegram bot by providing its name and token.</p>
                        
                        <form method="POST" novalidate>
                            {% csrf_token %}
                            <input type="hidden" name="form_type" value="add_bot">
                            <div class="settings-form-grid">
                                <div class="settings-form-field">
                                    <label for="{{ bot_form.name.id_for_label }}">{{ bot_form.name.label }}</label>
                                    {{ bot_form.name }}
                                    {% if bot_form.name.errors %}
                                        <div class="invalid-feedback">{{ bot_form.name.errors|striptags }}</div>
                                    {% endif %}
                                </div>
                                <div class="settings-form-field">
                                    <label for="{{ bot_form.token.id_for_label }}">{{ bot_form.token.label }}</label>
                                    {{ bot_form.token }}
                                    {% if bot_form.token.errors %}
                                        <div class="invalid-feedback">{{ bot_form.token.errors|striptags }}</div>
                                    {% endif %}
                                </div>
                                <div class="settings-form-field">
                                    <label for="{{ bot_form.is_active.id_for_label }}">{{ bot_form.is_active.label }}</label>
                                    <div class="form-check form-switch" style="padding-top: 0.5rem;">
                                        {{ bot_form.is_active }}
                                    </div>
                                </div>
                            </div>
                            <button type="submit" class="btn btn-gold">
                                <i class="fas fa-plus me-2"></i>Add Bot
                            </button>
                        </form>
                    </div>

                    <hr class="settings-divider">

                    <div class="settings-form-group">
                        <h3>Existing Bots</h3>
                        <p>View and manage your configured Telegram bots.</p>
                        
                        {% if bots %}
                            <div class="table-responsive" style="border-radius: var(--radius-sm); overflow: hidden;">
                                <table class="settings-table">
                                    <thead>
                                        <tr>
                                            <th>Name</th>
                                            <th>Token (masked)</th>
                                            <th>Status</th>
                                            <th>Channels</th>
                                            <th>Created</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {% for bot in bots %}
                                        <tr>
                                            <td>{{ bot.name }}</td>
                                            <td style="font-family: monospace; font-size: 0.875rem;">
                                                {% if bot.token|length > 20 %}
                                                    {{ bot.token|slice:":10" }}...{{ bot.token|slice:"-5:" }}
                                                {% else %}
                                                    ****
                                                {% endif %}
                                            </td>
                                            <td>
                                                {% if bot.is_active %}
                                                    <span class="badge" style="background: var(--color-success-soft); color: var(--color-success);">Active</span>
                                                {% else %}
                                                    <span class="badge" style="background: rgba(108, 117, 125, 0.2); color: var(--color-text-muted);">Inactive</span>
                                                {% endif %}
                                            </td>
                                            <td>{{ bot.channels.count }}</td>
                                            <td>{{ bot.created_at|date:"Y-m-d H:i" }}</td>
                                            <td>
                                                <a href="{% url 'setting:edit_bot' bot.id %}" class="btn btn-sm btn-outline-gold me-2">
                                                    <i class="fas fa-edit"></i> Edit
                                                </a>
                                                <form method="POST" action="{% url 'setting:delete_bot' bot.id %}" style="display: inline;" onsubmit="return confirm('Are you sure you want to delete this bot? This will also delete all associated channels.');">
                                                    {% csrf_token %}
                                                    <button type="submit" class="btn btn-sm btn-outline-danger" name="delete_bot">
                                                        <i class="fas fa-trash"></i> Delete
                                                    </button>
                                                </form>
                                            </td>
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        {% else %}
                            <div class="settings-empty-state">
                                <i class="fas fa-robot"></i>
                                <p>No bots configured yet. Add your first bot above.</p>
                            </div>
                        {% endif %}
                    </div>
                </div>

                <!-- Channels Management -->
                <div class="settings-section-card">
                    <div class="settings-section-header">
                        <h2>Telegram Channels</h2>
                        <p class="settings-section-description">Manage your Telegram channels and their associations with bots.</p>
                    </div>

                    <div class="settings-form-group">
                        <h3>Add New Channel</h3>
                        <p>Connect a Telegram channel to a bot for message sending.</p>
                        
                        <form method="POST" novalidate>
                            {% csrf_token %}
                            <input type="hidden" name="form_type" value="add_channel">
                            <div class="settings-form-grid">
                                <div class="settings-form-field">
                                    <label for="{{ channel_form.bot.id_for_label }}">{{ channel_form.bot.label }}</label>
                                    {{ channel_form.bot }}
                                    {% if channel_form.bot.errors %}
                                        <div class="invalid-feedback">{{ channel_form.bot.errors|striptags }}</div>
                                    {% endif %}
                                </div>
                                <div class="settings-form-field">
                                    <label for="{{ channel_form.name.id_for_label }}">{{ channel_form.name.label }}</label>
                                    {{ channel_form.name }}
                                    {% if channel_form.name.errors %}
                                        <div class="invalid-feedback">{{ channel_form.name.errors|striptags }}</div>
                                    {% endif %}
                                </div>
                                <div class="settings-form-field">
                                    <label for="{{ channel_form.chat_id.id_for_label }}">{{ channel_form.chat_id.label }}</label>
                                    {{ channel_form.chat_id }}
                                    {% if channel_form.chat_id.errors %}
                                        <div class="invalid-feedback">{{ channel_form.chat_id.errors|striptags }}</div>
                                    {% endif %}
                                </div>
                                <div class="settings-form-field">
                                    <label for="{{ channel_form.is_active.id_for_label }}">{{ channel_form.is_active.label }}</label>
                                    <div class="form-check form-switch" style="padding-top: 0.5rem;">
                                        {{ channel_form.is_active }}
                                    </div>
                                </div>
                            </div>
                            <button type="submit" class="btn btn-gold">
                                <i class="fas fa-plus me-2"></i>Add Channel
                            </button>
                        </form>
                    </div>

                    <hr class="settings-divider">

                    <div class="settings-form-group">
                        <h3>Existing Channels</h3>
                        <p>View and manage your configured Telegram channels.</p>
                        
                        {% if channels %}
                            <div class="table-responsive" style="border-radius: var(--radius-sm); overflow: hidden;">
                                <table class="settings-table">
                                    <thead>
                                        <tr>
                                            <th>Name</th>
                                            <th>Bot</th>
                                            <th>Chat ID</th>
                                            <th>Status</th>
                                            <th>Created</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        {% for channel in channels %}
                                        <tr>
                                            <td>{{ channel.name }}</td>
                                            <td>{{ channel.bot.name }}</td>
                                            <td style="font-family: monospace; font-size: 0.875rem;">{{ channel.chat_id }}</td>
                                            <td>
                                                {% if channel.is_active %}
                                                    <span class="badge" style="background: var(--color-success-soft); color: var(--color-success);">Active</span>
                                                {% else %}
                                                    <span class="badge" style="background: rgba(108, 117, 125, 0.2); color: var(--color-text-muted);">Inactive</span>
                                                {% endif %}
                                            </td>
                                            <td>{{ channel.created_at|date:"Y-m-d H:i" }}</td>
                                            <td>
                                                <a href="{% url 'setting:edit_channel' channel.id %}" class="btn btn-sm btn-outline-gold me-2">
                                                    <i class="fas fa-edit"></i> Edit
                                                </a>
                                                <form method="POST" action="{% url 'setting:delete_channel' channel.id %}" style="display: inline;" onsubmit="return confirm('Are you sure you want to delete this channel?');">
                                                    {% csrf_token %}
                                                    <button type="submit" class="btn btn-sm btn-outline-danger" name="delete_channel">
                                                        <i class="fas fa-trash"></i> Delete
                                                    </button>
                                                </form>
                                            </td>
                                        </tr>
                                        {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                        {% else %}
                            <div class="settings-empty-state">
                                <i class="fas fa-broadcast-tower"></i>
                                <p>No channels configured yet. Add your first channel above.</p>
                            </div>
                        {% endif %}
                    </div>
                </div>

                <!-- Send Message -->
                <div class="settings-section-card">
                    <div class="settings-section-header">
                        <h2>Send Telegram Message</h2>
                        <p class="settings-section-description">Send messages directly to your Telegram channels from here.</p>
                    </div>

                    <div class="settings-form-group">
                        <form method="POST" novalidate>
                            {% csrf_token %}
                            <input type="hidden" name="form_type" value="send_message">
                            
                            <div class="settings-form-grid">
                                <div class="settings-form-field">
                                    <label for="{{ telegram_form.bot.id_for_label }}">{{ telegram_form.bot.label }}</label>
                                    {{ telegram_form.bot }}
                                    {% if telegram_form.bot.help_text %}
                                        <small class="form-text">{{ telegram_form.bot.help_text }}</small>
                                    {% endif %}
                                    {% if telegram_form.bot.errors %}
                                        <div class="invalid-feedback">{{ telegram_form.bot.errors|striptags }}</div>
                                    {% endif %}
                                </div>
                                
                                <div class="settings-form-field">
                                    <label for="{{ telegram_form.channel.id_for_label }}">{{ telegram_form.channel.label }}</label>
                                    {{ telegram_form.channel }}
                                    {% if telegram_form.channel.help_text %}
                                        <small class="form-text">{{ telegram_form.channel.help_text }}</small>
                                    {% endif %}
                                    {% if telegram_form.channel.errors %}
                                        <div class="invalid-feedback">{{ telegram_form.channel.errors|striptags }}</div>
                                    {% endif %}
                                </div>
                            </div>
                            
                            <div class="settings-form-field">
                                <label for="{{ telegram_form.message.id_for_label }}">{{ telegram_form.message.label }}</label>
                                {{ telegram_form.message }}
                                {% if telegram_form.message.help_text %}
                                    <small class="form-text">{{ telegram_form.message.help_text }}</small>
                                {% endif %}
                                {% if telegram_form.message.errors %}
                                    <div class="invalid-feedback">{{ telegram_form.message.errors|striptags }}</div>
                                {% endif %}
                            </div>
                            
                            {% if telegram_form.non_field_errors %}
                                <div class="alert alert-danger">
                                    {{ telegram_form.non_field_errors }}
                                </div>
                            {% endif %}
                            
                            <button type="submit" class="btn btn-gold">
                                <i class="fas fa-paper-plane me-2"></i>Send Message
                            </button>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Notifications Section -->
            <div class="settings-section-content {% if active_section == 'notifications' %}active{% endif %}" id="section-notifications">
                <div class="settings-section-card">
                    <div class="settings-section-header">
                        <h2>Notifications</h2>
                        <p class="settings-section-description">Configure how and when you receive notifications from the system.</p>
                    </div>

                    <div class="settings-form-group">
                        <h3>Notification Preferences</h3>
                        <p>Manage your notification settings and delivery methods.</p>
                        
                        <div class="settings-empty-state">
                            <i class="fas fa-bell-slash"></i>
                            <p>Notification settings will be available soon.</p>
                        </div>
                    </div>

                    <div class="settings-save-btn">
                        <button type="button" class="btn btn-gold" onclick="showSaveStatus('notifications')">
                            <i class="fas fa-save me-2"></i>Save Changes
                        </button>
                        <span class="settings-status" id="status-notifications"></span>
                    </div>
                </div>
            </div>

            <!-- Advanced Section -->
            <div class="settings-section-content {% if active_section == 'advanced' %}active{% endif %}" id="section-advanced">
                <div class="settings-section-card">
                    <div class="settings-section-header">
                        <h2>Advanced Settings</h2>
                        <p class="settings-section-description">Access advanced configuration options and system-level settings.</p>
                    </div>

                    <div class="settings-form-group">
                        <h3>System Configuration</h3>
                        <p>Advanced settings for system administrators.</p>
                        
                        <div class="settings-empty-state">
                            <i class="fas fa-cog"></i>
                            <p>Advanced settings will be available soon.</p>
                        </div>
                    </div>

                    <div class="settings-save-btn">
                        <button type="button" class="btn btn-gold" onclick="showSaveStatus('advanced')">
                            <i class="fas fa-save me-2"></i>Save Changes
                        </button>
                        <span class="settings-status" id="status-advanced"></span>
                    </div>
                </div>
            </div>
        </main>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Theme Management
    const currentTheme = document.documentElement.getAttribute('data-theme') || 'light';
    const darkBtn = document.getElementById('themeDarkBtn');
    const lightBtn = document.getElementById('themeLightBtn');
    
    if (currentTheme === 'dark') {
        darkBtn.classList.add('active');
        lightBtn.classList.remove('active');
    } else {
        lightBtn.classList.add('active');
        darkBtn.classList.remove('active');
    }
    
    darkBtn.addEventListener('click', function() {
        switchTheme('dark');
    });
    
    lightBtn.addEventListener('click', function() {
        switchTheme('light');
    });
    
    function switchTheme(theme) {
        document.documentElement.setAttribute('data-theme', theme);
        localStorage.setItem('theme', theme);
        
        // Update button states
        if (theme === 'dark') {
            darkBtn.classList.add('active');
            lightBtn.classList.remove('active');
        } else {
            lightBtn.classList.add('active');
            darkBtn.classList.remove('active');
        }
        
        const themeIcon = document.getElementById('themeIcon');
        if (themeIcon) {
            themeIcon.className = theme === 'light' ? 'bi bi-sun' : 'bi bi-moon';
        }
        
        // Show save status
        showSaveStatus('appearance');
    }
    
    // Section Navigation (for smooth scrolling on mobile)
    const navLinks = document.querySelectorAll('.settings-nav-link');
    navLinks.forEach(link => {
        link.addEventListener('click', function(e) {
            // Remove active class from all links and sections
            navLinks.forEach(l => l.classList.remove('active'));
            document.querySelectorAll('.settings-section-content').forEach(s => s.classList.remove('active'));
            
            // Add active class to clicked link
            this.classList.add('active');
            
            // Show corresponding section
            const sectionId = this.getAttribute('data-section');
            const section = document.getElementById('section-' + sectionId);
            if (section) {
                section.classList.add('active');
            }
            
            // Scroll to top on mobile
            if (window.innerWidth < 992) {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        });
    });
});

// Save Status Function
function showSaveStatus(section) {
    const statusEl = document.getElementById('status-' + section);
    if (!statusEl) return;
    
    // Show saving
    statusEl.className = 'settings-status saving show';
    statusEl.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Saving...';
    
    // Simulate save (in real implementation, this would be an AJAX call)
    setTimeout(() => {
        statusEl.className = 'settings-status saved show';
        statusEl.innerHTML = '<i class="fas fa-check"></i> Saved';
        
        // Hide after 3 seconds
        setTimeout(() => {
            statusEl.classList.remove('show');
        }, 3000);
    }, 800);
}
</script>
{% endblock %}
